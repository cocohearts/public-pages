<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../../img/favicon.ico">
        <title>Rust notes - My Docs</title>
        <link href="../../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../../..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../../../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../Material Knowledge/Sciences/Coding/Crypto/Proving Systems (Plonky3, Halo2, Circle STARKs, Binius).md" class="dropdown-item">ZK Notes</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Coding <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../Material Knowledge/Sciences/Coding/Vim Tricks.md" class="dropdown-item">Vim Tricks</a>
</li>
                                    
<li>
    <a href="../../USACO/General%20Thoughts%2C%20Paradigms/" class="dropdown-item">USACO Notes</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Food and Cooking <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../糖醋排骨.md" class="dropdown-item">糖醋排骨</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#rust-compiler-stronk" class="nav-link">Rust Compiler Stronk</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#typing-choices" class="nav-link">Typing choices</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#other-rust-specifics" class="nav-link">Other Rust specifics</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>Rust is a parallel language to C++, with many similar ideas (static typing, compiled language) but also many new ones (very strong compiler guarantees, safe/unsafe code).</p>
<p>Here are some the of the key ideas.</p>
<h1 id="rust-compiler-stronk">Rust Compiler Stronk</h1>
<h3 id="ownership">Ownership</h3>
<p>Every item is owned by some variable name. The code must always "know" what each object is owned by. For instance, a vector owns all of its constituents. These are the permitted operations:
- Immutable borrow (must be "returned")
- Mutable borrow (can write, nobody else can borrow, must be "returned")
- Move (change ownership, previous variable gets "consumed")
When passing <code>&amp;var</code> or <code>&amp;mut var</code> in a function signature, that's a borrow. But when directly passing <code>var</code>, that's a move, and the original variable cannot be accessed anymore.</p>
<p>Consuming can be a good API for when an object should not be used anymore after a function call, i.e. all of the important guts got "moved" out.</p>
<p>There's lots of work that goes into moving objects that can't be <code>clone()</code>, such as <code>remove()</code> and <code>swap()</code>.</p>
<h3 id="lifetimes">Lifetimes</h3>
<p>There are also lifetimes, which the compiler usually infers but sometimes special things need to be done.
- Suppose A has a skateboard, B borrows the skateboard from A, and C borrows a sticker on the skateboard from B. Then C gives the sticker to D (function return).
- The first borrow must last at least as long as the second borrow, i.e. the reference must live at least as long.</p>
<p>This is only used when change of scope happens and the second reference moves out of the scope e.g. function calls. If the sticker is borrowed in "inline" code the skateboard reference is immediately required to live that long.</p>
<h3 id="safety-paradigms">Safety paradigms</h3>
<p>C++ makes the choice of making the programmer check guarantees at <em>runtime</em>. The Rust compiler enforces certain guarantees at <em>compile-time</em> so that those bugs can be found earlier by the compiler, rather than in production.</p>
<p>The errors thrown at compiletime are usually <em>panics</em>, such as division by zero, unwrapping a None value, </p>
<h1 id="typing-choices">Typing choices</h1>
<h3 id="traits">Traits</h3>
<p>Rust borrows a lot from type theory, while mixing in some of the compiled-language efficiency of C++. Namely, all objects have static types, defined with the <code>struct</code> keyword.</p>
<p>Traits are a "property" that multiple types can satisfy. Traits can provide "associated types" and methods.</p>
<p>Functions have their arguments be a certain type, but they can also have arguments satisfy certain traits.</p>
<h3 id="generics">Generics</h3>
<p>Syntactically, generic types are integrated into function signatures and traits in a way different from other languages. Rust's rigorous type checking encourages frequent use of generics. Generics can also be required to have trait bounds, so that e.g. an argument assumed to be of a certain type satisfying a given trait can call the methods from that trait, and Rust will know those methods exist.</p>
<p>Traits with different generics become different traits, so <code>MyTrait&lt;i32&gt;</code> and <code>MyTrait&lt;bool&gt;</code> can both be implemented by the same type.</p>
<h3 id="enums">Enums</h3>
<p>An enum is syntactic sugar for some type to be one of a list of hard-coded types. There is special <code>match</code> syntax that allows for concise control flow depending on the type of an enum.</p>
<h3 id="the-optiont-type">The <code>Option&lt;T&gt;</code> type</h3>
<p>The <code>Null</code> type is just horrible. Hence, the <code>Option&lt;T&gt;</code>, which is an enum for either <code>None</code> or <code>T</code>. Calling <code>None.unwrap()</code> will <code>panic!()</code>.</p>
<h3 id="trait-objects">Trait objects</h3>
<p>There is a special <code>&amp;dyn Trait</code> keyword that allows for pointers to a set of objects that satisfy a given trait. Then these objects could be any type that implements the trait, allowing for expandable features.
This is implemented under the hood with a <em>vtable</em> matching types to function pointers.</p>
<h3 id="smart-pointers">Smart pointers</h3>
<p>There's <code>Box</code>, <code>Mutex</code>, <code>Rc</code>, <code>Arc</code>, when the reference doesn't suffice. Just google if necessary.</p>
<p>Specifically, the <code>Box</code> moves its contents to heap and adds a pointer to the object on the stack, returning the pointer. It puts the object in a box.</p>
<h1 id="other-rust-specifics">Other Rust specifics</h1>
<h3 id="iterators">Iterators</h3>
<p>Oh, my god! these are awesome. Calling <code>.iter()</code> on a collection will create an object satisfying the <code>Iterator</code> trait, i.e. it has <code>next()</code> etc. creating immutable borrow. Then there's <code>iter_mut()</code> which returns mutable borrows, and <code>into_iter()</code> creating iterators that own the respective objects.</p>
<h3 id="unsafe-code">Unsafe code</h3>
<p>When exposing some key functionality such as splitting a vector (consuming a mutable slice and returning two halves of that slice) unsafe code must be used. It's wrapped in a <code>unsafe</code> code block, and it's up to the programmer to check that the <em>contracts</em> of that function are satisfied.</p>
<h3 id="tests">Tests</h3>
<p>Rust has builtin configs such as <code>#[cfg(test)]</code> that makes unit tests and integration tests very easy.</p>
<h3 id="routing">Routing</h3>
<p>Code is organized into crates. Crates are split into "library" denoted by <code>src</code> and "binary" denoted by <code>bin</code>. The binaries are meant for production, and libraries as APIs for binaries or other projects.</p>
<p>Cyclic imports between crates is not allowed, but any imports within one crate is fine. Imports from other crates need to be declared in <code>Cargo.toml</code>, along with other compilation and testing options. <code>mod</code> creates a module, and <code>use</code> imports things.</p>
<p>Obviously, the placement and naming of files can determine their import paths.</p>
<h3 id="macros">Macros</h3>
<p>Every <code>#[...]</code> generates code of some kind, using a <code>TokenStream</code> of the code block below it. All the <code>macro!()</code> lines apply some pattern to generate code in place at compile time, in a way similar to functions, except the assembly is quite literally expanded.</p>
<h3 id="parallelism">Parallelism</h3>
<p>Can initiate multiple threads. Object must implement <code>Send</code> if its ownership is going to be transferred to another thread, and must implement <code>Sync</code> if its references can be sent between threads (i.e. multiple threads can read/write). So constants are Send, and Arc/Mutex are Sync, etc.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../../../js/jquery-3.6.0.min.js"></script>
        <script src="../../../../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../../js/base.js"></script>
        <script src="../../../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
