## Problem 1
### (a)
The assumption is valid. Because $s$ is left-multiplied as a row vector, it's equivalent to zeroing out the first half of $s,$ i.e. dividing $n$ by two. By definition, the negligible win probability of the adversary is still negligible even after doubling the argument.
### (b)
The assumption is now broken because the first element of $sA$ is now zero. Hence the first element of $sA+e$ is distributed according to $\chi$ which is nonuniform.
### (c)
The assumption is now broken because $v=sA$ satisfies $v[0]+v[1]=v[-1],$ hence $u=sA+e$ satisfies $u[0]-\chi_{1}+u[1]-\chi_{1}=u[-1]-\chi_{-1}$ where $\chi_{i}$ are samples from $\chi.$ Clearly it is impossible for $u[0],u[1],u[-1]$ to be uniform i.i.d under these constraints, since $u[-1]$ is a bounded distance away from $u[0]+u[1]$.
### (d)
Setting the last $s_{n}=\sum ^{n-1}s_{i}$ is equivalent to setting $A_{i}:=A_{i}+A_{n}$ (row vectors), then dropping $s_{n}$ and $A_{n}.$ Then the resulting $A'$ is still uniform iid, and we only decreased $n$ by 1 so the assumption still holds.
## Problem 2
### (a)
No; evaluate $MAC(k,m_{1}\| m_{2})=(F_{1},F_{2}),$ and then the adversary knows $MAC(k,m_{2}\|m_{1})=(F_{2},F_{1}).$
### (b)
Without any queries, the adversary knows $MAC(k,m_{1}\|m_{1})=F(k,m_{1})\oplus F(k,m_{1})=0.$
### (c)
No;, evaluate $MAC(k,m_{1})=n$, then the adversary knows $MAC(k,m_{1}\|m_{2})=F(n,m_{2})$ which is computable by the adversary.
## Problem 3
### (a)
The decryption algorithm has access to the secret key $k$ by definition. Compute
$$
M_{i}:=f_{L}(i)\oplus E_{k}^{-1}(f_{L}(i)\oplus C_{i})
$$
for $i=1,\dots,m-1,$ and then since $\text{len}(M_m)=\text{len}(0^{n})$ compute $M_{m}=C_{m}\oplus E_{k}(f_{L}(m)\oplus \text{len}(0^{n})).$

Finally verify the tag by computing the checksum, and checking that
$$T=E_{k}(f_{L}(m)\oplus f_{L}(m+1)\oplus \texttt{checksum}).$$
### (b)
OCB has authentication, which neither CBC or Counter mode have. Furthermore OCB encryption/decryption can be done in parallel, without having to do $n$ sequential decrypts.
### (c)
Note that given a plaintext $M'=M_{1},$ the ciphertext and tag are
$$
C_{1}'=M_{1}\oplus E_{k}(f_{L}(1)\oplus \text{len}(M_{1})),
\qquad
T'=E_{k}(f_{L}(1)\oplus f_{L}(2)\oplus M_{1}).
$$
Hence by setting $M_{1}=f_{L}(2)\oplus \text{len}(0^{n}),$ we get $C_{1}'=M_{1}\oplus C_{1}\oplus f_{L}(1)$ and $T'=f_{L}(1)\oplus C_{1},$ both of which the adversary can compute.
### (d)
The bottom cycles through from $0,1,\dots,63$ and the top only changes once every 64 increments. Hence $K_{top}$ and $Stretch$ only need to be recomputed one every 64 increments.
### (e)
We can cache Top, $K_{top}$ and $Stretch$ every 64 increments, so that the only online computation required on one call of $Init$ is $L\gets Stretch << Bottom$, which is quite cheap.
## Problem 4
### (a)
Note that
$$
\pi ^{-1}(m_{1})\oplus c_{1}=(m_{0}\oplus k)\oplus (\pi (c_{0})\oplus k)=m_{0}\oplus \pi(c_{0}),
$$
so set $f(m,c):=m\oplus \pi(c)$ and $g(m,c):= \pi ^{-1}(m)\oplus c.$
### (b)
If $t=c\sqrt{ N }$ then there are a total of $c^{2}N$ pairs $f(m_{i}),g(m_{j})$ each of which has $\frac{1}{N}$ chance of collision, so the expected number of pairs of collisions is $c^{2}$, hence at least $\frac{1}{c^{2}}$ likelihood of a collision.
### (c)
331496496133